import{b as p,c as m,d as a}from"./chunk-AJEUVWKL.js";import{M as g,b as u,h,m as d,w as n}from"./chunk-WAGJM7NU.js";import{g as l}from"./chunk-MYAK5QVS.js";var U=(()=>{class i{constructor(){this.apiUrl=new p().getUrl(m),this.lists=this.apiUrl+"nav/listing/",this.processing=this.apiUrl+"nav/",this.deletion=this.apiUrl+"nav/",this.amc=this.apiUrl+"amcEntry/",this.fundName=this.apiUrl+"fund/",this.fetchNav=this.apiUrl+"nav/fetch/"}getAuthHeaders(){return{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}listsNav(e=100,t="",r=""){let s=new URLSearchParams({page_size:e.toString(),search:t,cursor:r}),c=`${this.lists}?${s.toString()}`;return h(a.get(c,{headers:this.getAuthHeaders()})).pipe(d(o=>({data:{code:o.data.code,data:o.data.data,message:o.data.message,next_cursor:o.data.next_cursor,total_count:o.data.total_count}})),n(o=>{throw console.error("Error in listsNav:",o),o}))}getTotalCount(e=""){let t=new URLSearchParams({search:e}),r=`${this.apiUrl}nav/total_count/?${t.toString()}`;return h(a.get(r,{headers:this.getAuthHeaders()})).pipe(d(s=>s.data.total_count),n(s=>{throw console.error("Error in getTotalCount:",s),s}))}searchAllRecords(e){let t=`${this.lists}?search=${e}&page_size=1000`;return new u(r=>{a.get(t,{headers:this.getAuthHeaders()}).then(s=>{r.next(s),r.complete()}).catch(s=>{console.error("Error in searchAllRecords:",s),r.error(s)})})}refreshNavList(e=100,t=""){return this.listsNav(e,t)}getNavById(e){return a.get(`${this.processing}${e}/list_for_update/`,{headers:this.getAuthHeaders()}).catch(t=>{throw console.error("Error in getNavById:",t),t})}deleteNav(e){return a.get(`${this.deletion}${e}/deletion/`,{headers:this.getAuthHeaders()}).then(t=>(t.data.code===1&&console.log("NAV deleted successfully"),t)).catch(t=>{throw console.error("Error in deleteNav:",t),t})}getAmc(){return a.get(this.amc,{headers:this.getAuthHeaders()}).catch(e=>{throw console.error("Error in getAmc:",e),e})}getFundName(){return a.get(this.fundName,{headers:this.getAuthHeaders()}).catch(e=>{throw console.error("Error in getFundName:",e),e})}getFundsByAmc(e){return l(this,null,function*(){try{return(yield a.get(`${this.apiUrl}nav/funds_by_amc/?amc_id=${e}`,{headers:this.getAuthHeaders()})).data.data}catch(t){throw console.error("Error in getFundsByAmc:",t),t}})}updateNav(e,t="0"){return h(a.post(`${this.processing}${t}/processing/`,e,{headers:this.getAuthHeaders()})).pipe(n(r=>{throw console.error("Error in updateNav:",r),r}))}getNavUpdateData(e){return a.get(`${this.apiUrl}nav/${e}/get_nav_update_data/`,{headers:this.getAuthHeaders()}).catch(t=>{throw console.error("Error in getNavUpdateData:",t),t})}fetchNavData(e){return a.post(this.fetchNav,{date:e},{headers:this.getAuthHeaders()}).catch(t=>{throw console.error("Error in fetchNavData:",t),t})}fetchHistoricNavData(e,t){return a.post(this.fetchNav,{start_date:e,end_date:t},{headers:this.getAuthHeaders()}).catch(r=>{throw console.error("Error in fetchHistoricNavData:",r),r})}listNavFallback(e=100,t="",r=""){let s=new URLSearchParams({page_size:e.toString(),search:t,cursor:r}),c=`${this.apiUrl}nav/listing_fallback/?${s.toString()}`;return h(a.get(c,{headers:this.getAuthHeaders()})).pipe(n(o=>{throw console.error("Error in listNavFallback:",o),o}))}checkApiHealth(){return l(this,null,function*(){try{return(yield a.get(`${this.apiUrl}nav/total_count/`,{headers:this.getAuthHeaders(),timeout:5e3})).status===200}catch(e){return console.error("API health check failed:",e),!1}})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{U as a};
