import{b as h,c as p,d as a}from"./chunk-AJEUVWKL.js";import{M as d,h as i,m as n,w as c}from"./chunk-WAGJM7NU.js";var E=(()=>{class o{constructor(){this.backendBaseUrl="https://backend.faiop.com",this.apiUrl=new h().getUrl(p),this.lists=this.apiUrl+"dailyEntry/listing/",this.processing=this.apiUrl+"dailyEntry/",this.deletion=this.apiUrl+"dailyEntry/",this.fetchFunds=this.apiUrl+"dailyEntry/get_funds_by_amc/",this.fetchClientDetails=this.apiUrl+"dailyEntry/get_client_details/",this.fetchTransactionModes=this.apiUrl+"transcationMode/"}getHeaders(){return{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}getMultipartHeaders(){return{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}listDailyEntries(t,s,r=""){let e=new URLSearchParams({page:t.toString(),page_size:s.toString(),search:r}),l=`${this.lists}?${e.toString()}`;return i(a.get(l,{headers:this.getHeaders()})).pipe(n(g=>g.data))}getTotalCount(t=""){let s=`${this.apiUrl}dailyEntry/total_count/?search=${t}`;return i(a.get(s,{headers:this.getHeaders()})).pipe(n(r=>r.data.total_count))}getDailyEntryById(t){return i(a.get(`${this.processing}${t}/list_for_update/`,{headers:this.getHeaders()})).pipe(n(s=>s.data))}processDailyEntryWithFormData(t,s="0"){console.log("FormData being sent to API:"),t&&typeof t.forEach=="function"&&t.forEach((e,l)=>{e instanceof File?console.log(`${l}: File - ${e.name} (${(e.size/1024/1024).toFixed(2)} MB)`):console.log(`${l}: ${e}`)});let r=`${this.processing}${s}/processing/`;return console.log("API Endpoint:",r),i(a.post(r,t,{headers:this.getMultipartHeaders(),timeout:3e4,maxContentLength:1/0,maxBodyLength:1/0})).pipe(n(e=>(console.log("API Response:",e.data),e.data)),c(e=>{throw console.error("API Error:",e),e.response&&(console.error("Error Response:",e.response.data),console.error("Error Status:",e.response.status)),e}))}processDailyEntry(t,s="0"){let r=new FormData;return Object.keys(t).forEach(e=>{t[e]!==null&&t[e]!==void 0&&(e==="dailyEntryFile"&&t[e]instanceof File?r.append(e,t[e]):r.append(e,String(t[e])))}),this.processDailyEntryWithFormData(r,s)}deleteDailyEntry(t){return i(a.get(`${this.deletion}${t}/deletion/`,{headers:this.getHeaders()})).pipe(n(s=>s.data))}getFundsByAmc(t){return i(a.get(`${this.fetchFunds}?amc_id=${t}`,{headers:this.getHeaders()})).pipe(n(s=>s.data))}getClientDetails(t){return i(a.get(`${this.fetchClientDetails}?search_term=${t}`,{headers:this.getHeaders()})).pipe(n(s=>s.data))}getTransactionModes(){return i(a.get(this.fetchTransactionModes,{headers:this.getHeaders()})).pipe(n(t=>t.data))}getFileUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;let s=t.startsWith("/")?t:`/${t}`;return`${this.backendBaseUrl}${s}`}downloadFile(t){let s=this.getFileUrl(t);return i(a.get(s,{headers:this.getHeaders(),responseType:"blob"})).pipe(n(r=>r.data))}getFileInfo(t){let s=this.getFileUrl(t);return i(a.head(s,{headers:this.getHeaders()})).pipe(n(r=>({size:r.headers["content-length"],type:r.headers["content-type"],lastModified:r.headers["last-modified"]})))}static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275prov=d({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{E as a};
